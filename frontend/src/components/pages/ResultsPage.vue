<!--
  @fileoverview ResultsPage component that displays benchmark results and allows users to download reports.
  @component ResultsPage
  @author Eva Ray
  @description  This component displays the results of the benchmark tests, allowing users to view detailed results and
  download reports.
  The style has been generated by an LLM.
-->

<template>
  <div class="results-page">
    <div class="results-header">
      <button @click="goHome" class="btn btn-large">
        Try another benchmark
      </button>
    </div>
    
    <!-- Display results based on the type -->
    <div v-if="isUniqueResults">
      <UniqueQueryResults :results="results" />
    </div>
    <div v-else>
      <WorkloadResults :results="results" />
    </div>
    
    <!-- Download section -->
    <div v-if="hasResults" class="report-section">
      <BenchmarkDownload :benchmark-data="results" />
    </div>
  </div>
</template>

<script setup>
import { inject, computed } from 'vue'
import WorkloadResults from '../results/WorkloadResults.vue'
import UniqueQueryResults from '../results/UniqueQueryResults.vue'
import BenchmarkDownload from '../param_selection/BenchmarkDownload.vue'

const results = inject('benchmarkResults', {})

/**
 * @description Function to navigate back to the home page.
 */
const goHome = () => {
  window.location.hash = '#/'
}

/**
 * @description Computed property to check if there are results available.
 * @return {boolean} True if results are available, false otherwise.
 */
const hasResults = computed(() => {
  return results.value && Object.keys(results.value).length > 0
})

/**
 * @description Computed property to determine if the results are from a unique query.
 * @return {boolean} True if results are from a unique query, false otherwise.
 */
const isUniqueResults = computed(() => {
  if (!results.value || Object.keys(results.value).length === 0) return false
  
  // Check if it's a unique query result by looking at the structure
  const firstKey = Object.keys(results.value)[0]
  const firstValue = results.value[firstKey]
  
  // If it has direct avgExecutionTime and queryPerSecond properties, it's unique
  return firstValue && typeof firstValue.avgExecutionTime === 'number' && typeof firstValue.queryPerSecond === 'number'
})
</script>

<style scoped>
.results-page {
  min-height: 100vh;
}

.results-header {
  display: flex;
  justify-content: flex-end;
  align-items: center;
  padding: 20px 0;
  margin-bottom: 20px;
  margin-right: 40px;
  border-bottom: 2px solid #e2e4ea;
}

.results-header h1 {
  margin: 0;
  color: #23272f;
}

.report-section {
  margin-top: 40px;
  text-align: center;
  display: flex;
  flex-direction: column;
  align-items: center;
}

@media (max-width: 768px) {
  .results-header {
    flex-direction: column;
    gap: 16px;
    text-align: center;
  }
}
</style>
