<!--
  @fileoverview WorkloadSelection component that allows users to select a workload for benchmarking.
  @component WorkloadSelection
  @author Eva Ray
  @description This component provides a selection interface for different workloads available in the system.
  It fetches the list of workloads from a server endpoint and allows users to select one workload. It also allows users
  to specify the number of executions for the selected workload. It emits the selected workload and number of executions
  to the parent component. The style has been generated by an LLM.
-->

<script setup>
import { ref, onMounted } from 'vue'

const workloads = ref([])

// Fetch available workloads from the server
onMounted(async () => {
  try {
    const response = await fetch('http://localhost:7070/meta/workloads')
    if (!response.ok) throw new Error('Network')
    workloads.value = await response.json()
    workloads.value.sort((a, b) => a.label.localeCompare(b.label))
  } catch (error) {
    console.error('Error loading queries:', error)
  }
})

const selectedWorkloadValue = ref('')
const numberOfExecutions = ref(1)

defineExpose({
    getSelections: () => {
        return {
            selectedWorkload: selectedWorkloadValue.value,
            numberOfExecutions: numberOfExecutions.value
        }
    }
})

</script>

<template>
    <div class="container">
        <h2>Workload</h2>
        <div class="form">
            <div class="form-row">
                <label for="workload-select">Type of workload :</label>
                <select id="workload-select" v-model="selectedWorkloadValue" class="dropdown">
                    <option disabled value="">Select workload</option>
                    <option v-for="w in workloads" :key="w.value" :value="w.value">
                        {{ w.label }}
                    </option>
                </select>
            </div>
            <div class="form-row">
                <label for="executions-input">Number of executions :</label>
                <input id="executions-input" v-model="numberOfExecutions" type="number" class="input" min="1"
                    step="1" />
            </div>
        </div>
    </div>
</template>

