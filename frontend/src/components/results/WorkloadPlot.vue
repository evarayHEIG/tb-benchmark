<!--
  @fileoverview WorkloadPlot component that displays execution time plots for different query types.
  @component WorkloadPlot
  @author Eva Ray
  @description This component takes benchmark data and groups it by query type, rendering execution time plots for each type.
  The style has been generated by an LLM.
 -->

<script setup>
import { computed } from 'vue'
import ExecutionTimePlot from './ExecutionTimePlot.vue'

const props = defineProps({
    chartData: {
        type: Array,
        required: true,
        default: () => []
    }
})

/**
 * Groups the chart data by query type and formats it for the ExecutionTimePlot component.
 * @returns {Object} An object where keys are query names and values are arrays of data points.
 */
const groupedByQuery = computed(() => {
    const grouped = {}

    props.chartData.forEach(item => {
        if (!grouped[item.queryName]) {
            grouped[item.queryName] = []
        }
        grouped[item.queryName].push({
            x: item.dbName,
            y: item.avgExecutionTime
        })
    })

    return grouped
})

</script>

<template>
    <div v-if="chartData && chartData.length > 0" class="content-container">
        <h2 class="text-center">Execution Time Plots by Query Type</h2>
        <div class="card-grid-large">
            <div v-for="(databases, queryName) in groupedByQuery" :key="queryName" class="card">
                <h4>{{ queryName }} Query</h4>
                <ExecutionTimePlot :data="databases" />
            </div>
        </div>
    </div>
    <div v-else class="no-data">
        <p>No benchmark data available</p>
        <p>{{ chartData?.length || 0 }} elements received</p>
    </div>
</template>

